To solve this problem efficiently, we need to find a way to calculate the expected number of dollar bills spent while considering the optimal number of bills, \(D\), to insert at each exchange, for given values of \(N\), the number of different coin denominations, and \(P\), the percentage increase in the chance of getting a new coin when inserting additional bills.

**Key Observations and Solution Strategy:**

1. **Probability of Getting a New Coin:**
   - When inserting \(D\) dollar bills, the probability of receiving a new coin is:
     \[
     p(D) = x(D) + (1 - x(D)) \cdot \left( \frac{N - k}{N} \right)
     \]
     where \(x(D) = \min\left( \frac{(D - 1) \cdot P}{100}, 1 \right)\), and \(k\) is the number of unique coins collected so far.

2. **Expected Bills to Get a New Coin:**
   - The expected number of bills to go from \(k\) to \(k+1\) unique coins is:
     \[
     c(D, k) = \frac{D}{p(D)}
     \]
   - Our goal is to find the \(D\) that minimizes \(c(D, k)\) at each step.

3. **Optimal \(D\) Based on Remaining Coins:**
   - There exists a crossover point \(s_{\text{crossover}} = \frac{P}{100 + P}\) such that:
     - For \(s = \frac{N - k}{N} > s_{\text{crossover}}\), the optimal strategy is to use \(D = 1\).
     - For \(s \leq s_{\text{crossover}}\), it becomes optimal to use a higher \(D\) where \(x(D) = 1\), which is \(D = \left\lceil \frac{100}{P} + 1 \right\rceil\).

4. **Total Expected Bills Calculation:**
   - We divide the process into two phases based on \(s_{\text{crossover}}\):
     - **Phase 1 (\(D = 1\)):** Collect coins until \(s = s_{\text{crossover}}\).
       - Expected bills in this phase:
         \[
         E_{\text{phase1}} = -\ln\left( \frac{P}{100 + P} \right)
         \]
     - **Phase 2 (\(D = D^*\)):** Use the optimal \(D\) to collect the remaining coins.
       - Expected bills in this phase:
         \[
         E_{\text{phase2}} = N \cdot \frac{P}{100 + P} \cdot D^*
         \]
   - **Total Expected Bills:**
     \[
     E_{\text{total}} = E_{\text{phase1}} + E_{\text{phase2}}
     \]

5. **Handling Edge Cases:**
   - When \(P = 0\), \(s_{\text{crossover}} = 0\), so we always use \(D = 1\).
     - Total expected bills is approximated by:
       \[
       E_{\text{total}} = N \cdot (\ln N + \gamma)
       \]
     where \(\gamma \approx 0.5772\) is the Euler-Mascheroni constant.

**Implementation Steps:**

- Read the number of test cases.
- For each test case:
  - Read \(N\) and \(P\).
  - Calculate \(s_{\text{crossover}}\).
  - Determine \(D^*\).
  - Compute \(E_{\text{phase1}}\) and \(E_{\text{phase2}}\).
  - Sum up to get \(E_{\text{total}}\).
  - Handle \(P = 0\) and \(P = 100\) as special cases if necessary.
  - Ensure that the output has a relative error within \(10^{-6}\).

**Python Code:**

```python
import sys
import math

def compute_expected_bills(N, P):
    if P == 0:
        # Expected bills when always using D=1
        gamma = 0.5772156649015328606  # Euler-Mascheroni constant
        return N * (math.log(N) + gamma)
    elif P == 100:
        # Optimal to use D=2 after the first coin
        if N == 1:
            return 1.0
        else:
            # Expected bills for the first coin
            E_first = 1.0
            # Expected bills to get second coin (with D=1)
            E_second = N / (N - 1)
            # Expected bills for remaining coins
            E_remaining = (N - 2) * 2
            return E_first + E_second + E_remaining
    else:
        s_crossover = P / (100.0 + P)
        k_crossover = N * (1 - s_crossover)
        D_star = math.ceil(100.0 / P + 1)
        # Expected bills in phase 1
        if s_crossover <= 0:
            E_phase1 = 0.0
        else:
            E_phase1 = -math.log(P / (100.0 + P))
        # Expected bills in phase 2
        E_phase2 = N * s_crossover * D_star
        E_total = E_phase1 + E_phase2
        return E_total

def main():
    T = int(sys.stdin.readline())
    for case_num in range(1, T + 1):
        N_str, P_str = sys.stdin.readline().split()
        N = int(N_str)
        P = int(P_str)
        expected_bills = compute_expected_bills(N, P)
        print(f"Case #{case_num}: {expected_bills}")

if __name__ == "__main__":
    main()
```